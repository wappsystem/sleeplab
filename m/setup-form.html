<div id=D__ID>
    <section id=form_container__ID>
    	<div id=header__ID>
    		Setup
    	</div>
    	<form id=F__ID>
    		<div class="container">
    			<div class="row row__ID">
    				<div class="col-sm col-lg-3">
    					<span>Date</span>
    					<input type="text" class="form-control" id=Date__ID readonly />
					</div>
    				<div class="col-sm col-lg-9">
						<span>Patient</span>
						<input type="text" class="form-control" id=Patient__ID readonly />
    				</div>
				</div>
    			<div class="row" style='font-size:11px;padding-left:10px'>
    				<div class="col">
						<span><u id=patient_link2__ID style='cursor:pointer'>Patient's records</u></span>
					</div>
				</div>
    			<div class="row row__ID">
    				<div class="col-sm col-lg-3" style='display:xnone'>
    					<span>Item Number</span>
    					<input type="text" class="form-control" id=Item_Number__ID  readonly />
					</div>
    				<div class="col-sm col-lg-9">
						<span>Item Number - Procedure</span>
						<input type="text" class="form-control" id=Item_Number_Procedure__ID readonly />
    				</div>
				</div>
    			<div class="row row__ID">
    				<div class="col-sm col-lg-6">
    					<span>Visit</span>
						<select class="form-control" name=Visit >
							<option ></option>
							<option >Arrived</option>
							<option >DNA</option>
						</select>
    				</div>
					<div class="col-sm col-lg-6">
						<span>Research Project</span>
						<input type="text" class="form-control" id=Research_Project__ID readonly />
					</div>
				</div>
    			<div class="row row__ID">
    				<div class="col" style='display:xnone'>
						<u style='cursor:pointer;margin-bottom:3px;display:inline-block' id=add_comment__ID><i class="fa fa-plus"></i> Click here to add comment</u>
						<input type="text" class="form-control" id=Add_Comment__ID  />
					</div>
				</div>
    			<div class="row row__ID">
    				<div class="col">
						<span>Comments</span>
						<textarea style='font-size:small' class="form-control" name=Comments readonly ></textarea>
    				</div>
				</div>
				<br>				
    			<div class="row">
    				<div class=col>
    					<button id=submit__ID type="submit" class="btn btn-secondary">Submit</button>
    					<button id=delete__ID type="button" class="btn btn-secondary">Delete</button>
    				</div>
    			</div>
    		</div>
    	</form>
    </section>
    <script>
    	function F__ID(){
    		//-------------------------------------
            VmInclude:__COMPONENT__/f/form.01.js
			VmInclude:__COMPONENT__/f/form-item-a.01.js
    		//-------------------------------------
			var $List1=$('#F__ID select[name=Time]');
			for(var i=12;i<24;i++){
				for(var j=0;j<2;j++){
					var t1=i;    if(t1<10) t1="0"+t1
					var t2=j*30; if(t2==0) t2="00";
					var t=t1+":"+t2;
					$List1.append(  $('<option></option>').val(t).html(t)  );
				}
			}
			//-------------------------------------
			var $List2=$('#F__ID select[name=Duration]');
			for(var i=0;i<15;i++){
				for(var j=0;j<2;j++){
					var t1=i;    if(t1<10) t1="0"+t1
					var t2=j*30; if(t2==0) t2="00";
					var t=t1+":"+t2;
					if(i==0 && j==0){} 
					else $List2.append(  $('<option></option>').val(t).html(t)  );
				}
			}
			//-------------------------------------
            old_load=m.load;
			m.load=function(){
				old_load();
				$('#Date__ID').val(m.input.booking.Data.Date)
				$('#Patient__ID').val(m.input.booking.Data.Patient)
				$('#Item_Number__ID').val(m.input.booking.Data.Item_Number)
				$('#Item_Number_Procedure__ID').val(m.input.booking.Data.Item_Number_Procedure)
				$('#Research_Project__ID').val(m.input.booking.Data.Research_Project)
				console.log(JSON.stringify(m.input.booking.Data))
			}
			//-------------------------------------
			$('#patient_link2__ID').on('click',function(){
				var uid=m.input.booking.UID;
				if(uid==""){
					$vm.alert("No patient was selected.");
					return;
				}
				$vm.request({cmd:"find",table:m.Table3,query:{UID:parseInt(uid)}},function(res){
					if(res.result.length==1){
						$vm.load_module('patient-form','',{record:res.result[0]});
					}
				});
			})
			//-------------------------------------
			$('#add_comment__ID').on('click',function(){
				var now_time=new Date();
				now_time=now_time.toString().split(" ");
				now_time=now_time[4];
				var now_date=$vm.date_to_string_dmy(new Date());
				var new_comments=$('#Add_Comment__ID').val();
				if(new_comments!=""){
					var old_comments=$('#F__ID textarea[name=Comments]').val()
					if($('#F__ID textarea[name=Comments]').val()==undefined) old_comments="";
					var comments=now_time+' '+now_date+" - "+$vm.user_name+"\n"+new_comments+"\n\n"+old_comments
					$('#F__ID textarea[name=Comments]').val(comments)
					$('#Add_Comment__ID').val("");
				}
				else $vm.alert("Please enter a comment")				
			})
			//-------------------------------------
			m.before_submit=function(data,index){
				data.booking_uid=m.input.booking.UID;
				index.I1=m.input.booking.Data.Date;
                //index.I2=data.Time;

            }
            //-------------------------------------
		}
		//-------------------------------

    </script>
    <style>
        #form_container__ID{
            max-width:800px;
        }
        VmInclude:__COMPONENT__/f/form.01.css
        VmInclude:__COMPONENT__/f/form-item-a.01.css
    </style>
</div>
